---
title: "JavaScript Examples"
description: "Complete JavaScript/Node.js examples for working with the ZipKit API"
---

## Overview

These examples show how to use ZipKit with JavaScript, both in Node.js and browser environments. We'll use the modern `fetch` API which is available in Node.js 18+ and all modern browsers.

## Prerequisites

- Node.js 18+ (for built-in fetch) or a browser
- A ZipKit account with an access token
- A configured bucket

## Basic Example: Create a ZIP

```javascript
const ACCESS_TOKEN = "your-access-token";
const API_URL = "https://zipkit.io/api/v1";

async function createZip() {
  const response = await fetch(`${API_URL}/zips`, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${ACCESS_TOKEN}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      urls: [
        'https://my-bucket.s3.amazonaws.com/report.pdf',
        'https://my-bucket.s3.amazonaws.com/data.csv'
      ],
      bucket_name: 'my-destination-bucket',
      key: 'archives/quarterly-report.zip'
    })
  });

  if (!response.ok) {
    throw new Error(`HTTP error! status: ${response.status}`);
  }

  const data = await response.json();
  const { id, status } = data.data;

  console.log(`ZIP created with ID: ${id}`);
  console.log(`Initial status: ${status}`);

  return data.data;
}

// Usage
createZip()
  .then(zip => console.log('Success:', zip))
  .catch(error => console.error('Error:', error));
```

## Check ZIP Status

```javascript
async function getZipStatus(zipId) {
  const response = await fetch(`${API_URL}/zips/${zipId}`, {
    headers: {
      'Authorization': `Bearer ${ACCESS_TOKEN}`
    }
  });

  if (!response.ok) {
    throw new Error(`HTTP error! status: ${response.status}`);
  }

  const data = await response.json();
  const { status } = data.data;

  console.log(`ZIP status: ${status}`);
  return data.data;
}

// Usage
getZipStatus('clx7g2m4p0000xyz123abc')
  .then(zip => console.log(zip))
  .catch(error => console.error(error));
```

## Complete ZipKit Client Class

```javascript
class ZipKitClient {
  constructor(accessToken) {
    this.accessToken = accessToken;
    this.apiUrl = 'https://zipkit.io/api/v1';
  }

  async createZip({ urls, bucketName, key = null, service = 's3' }) {
    const body = {
      urls,
      bucket_name: bucketName,
      service
    };

    if (key) {
      body.key = key;
    }

    const response = await fetch(`${this.apiUrl}/zips`, {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${this.accessToken}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(body)
    });

    if (!response.ok) {
      const error = await response.json();
      throw new Error(`Failed to create ZIP: ${error.message || response.statusText}`);
    }

    const data = await response.json();
    return data.data;
  }

  async getZipStatus(zipId) {
    const response = await fetch(`${this.apiUrl}/zips/${zipId}`, {
      headers: {
        'Authorization': `Bearer ${this.accessToken}`
      }
    });

    if (!response.ok) {
      throw new Error(`Failed to get ZIP status: ${response.statusText}`);
    }

    const data = await response.json();
    return data.data;
  }

  async waitForZip(zipId, { maxAttempts = 30, delay = 2000 } = {}) {
    for (let attempt = 1; attempt <= maxAttempts; attempt++) {
      const zip = await this.getZipStatus(zipId);
      const { status } = zip;

      console.log(`Attempt ${attempt}/${maxAttempts}: Status is '${status}'`);

      if (status === 'succeeded') {
        return zip;
      } else if (status === 'failed') {
        throw new Error(`ZIP creation failed for ID: ${zipId}`);
      }

      // Wait before next attempt
      await new Promise(resolve => setTimeout(resolve, delay));
    }

    throw new Error(`ZIP did not complete within ${maxAttempts} attempts`);
  }
}

// Usage
const client = new ZipKitClient('your-access-token');

async function main() {
  try {
    // Create ZIP
    console.log('Creating ZIP...');
    const zip = await client.createZip({
      urls: [
        'https://example.com/file1.pdf',
        'https://example.com/file2.jpg'
      ],
      bucketName: 'my-destination-bucket',
      key: 'my-archive.zip'
    });

    console.log(`ZIP ID: ${zip.id}`);

    // Wait for completion
    const completedZip = await client.waitForZip(zip.id);
    console.log('✓ ZIP created successfully!');
    console.log('  Location: my-destination-bucket/my-archive.zip');

  } catch (error) {
    console.error('✗ Error:', error.message);
  }
}

main();
```

## Using with TypeScript

```typescript
interface ZipResponse {
  data: {
    id: string;
    status: 'none' | 'processing' | 'succeeded' | 'failed';
  };
}

interface CreateZipOptions {
  urls: string[];
  bucketName: string;
  key?: string;
  service?: 's3' | 'r2';
}

class ZipKitClient {
  private accessToken: string;
  private apiUrl: string = 'https://zipkit.io/api/v1';

  constructor(accessToken: string) {
    this.accessToken = accessToken;
  }

  async createZip(options: CreateZipOptions): Promise<ZipResponse['data']> {
    const body: any = {
      urls: options.urls,
      bucket_name: options.bucketName,
      service: options.service || 's3'
    };

    if (options.key) {
      body.key = options.key;
    }

    const response = await fetch(`${this.apiUrl}/zips`, {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${this.accessToken}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(body)
    });

    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    const data: ZipResponse = await response.json();
    return data.data;
  }

  async getZipStatus(zipId: string): Promise<ZipResponse['data']> {
    const response = await fetch(`${this.apiUrl}/zips/${zipId}`, {
      headers: {
        'Authorization': `Bearer ${this.accessToken}`
      }
    });

    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    const data: ZipResponse = await response.json();
    return data.data;
  }

  async waitForZip(
    zipId: string,
    maxAttempts: number = 30,
    delay: number = 2000
  ): Promise<ZipResponse['data']> {
    for (let attempt = 1; attempt <= maxAttempts; attempt++) {
      const zip = await this.getZipStatus(zipId);

      console.log(`Attempt ${attempt}/${maxAttempts}: ${zip.status}`);

      if (zip.status === 'succeeded') {
        return zip;
      } else if (zip.status === 'failed') {
        throw new Error(`ZIP creation failed: ${zipId}`);
      }

      await new Promise(resolve => setTimeout(resolve, delay));
    }

    throw new Error(`Timeout waiting for ZIP: ${zipId}`);
  }
}

// Usage
const client = new ZipKitClient(process.env.ZIPKIT_TOKEN!);

async function example() {
  const zip = await client.createZip({
    urls: ['https://example.com/file.pdf'],
    bucketName: 'my-bucket',
    key: 'archive.zip'
  });

  const result = await client.waitForZip(zip.id);
  console.log('Complete:', result);
}

example();
```

## Express.js Webhook Handler

```javascript
const express = require('express');
const app = express();

app.use(express.json());

// Your webhook secret
const WEBHOOK_SECRET = process.env.ZIPKIT_WEBHOOK_SECRET;

app.post('/webhooks/zipkit', (req, res) => {
  // Verify authorization
  const authHeader = req.headers.authorization;

  if (authHeader !== `Bearer ${WEBHOOK_SECRET}`) {
    return res.status(401).json({ error: 'Unauthorized' });
  }

  // Parse webhook payload
  const { zip_id, status, bucket, key, checksum } = req.body;

  console.log(`Received webhook for ZIP ${zip_id}`);

  if (status === 'succeeded') {
    console.log(`✓ ZIP succeeded`);
    console.log(`  Bucket: ${bucket.name}`);
    console.log(`  Key: ${key}`);
    console.log(`  Checksum: ${checksum}`);

    // Process the completed ZIP
    // processZip(bucket.name, key);

  } else if (status === 'failed') {
    console.log(`✗ ZIP failed: ${zip_id}`);

    // Handle failure
    // handleFailedZip(zip_id);
  }

  // Return 200 to acknowledge receipt
  res.status(200).json({ received: true });
});

const PORT = process.env.PORT || 3000;
app.listen(PORT, () => {
  console.log(`Webhook server listening on port ${PORT}`);
});
```

## Browser Example (ES6 Modules)

```html
<!DOCTYPE html>
<html>
<head>
  <title>ZipKit Browser Example</title>
</head>
<body>
  <h1>ZipKit Browser Example</h1>
  <button id="createZip">Create ZIP</button>
  <div id="status"></div>

  <script type="module">
    const ACCESS_TOKEN = 'your-access-token';
    const API_URL = 'https://zipkit.io/api/v1';

    class ZipKitClient {
      constructor(accessToken) {
        this.accessToken = accessToken;
        this.apiUrl = API_URL;
      }

      async createZip({ urls, bucketName, key }) {
        const response = await fetch(`${this.apiUrl}/zips`, {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${this.accessToken}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            urls,
            bucket_name: bucketName,
            key
          })
        });

        if (!response.ok) {
          throw new Error(`Error: ${response.statusText}`);
        }

        const data = await response.json();
        return data.data;
      }

      async getZipStatus(zipId) {
        const response = await fetch(`${this.apiUrl}/zips/${zipId}`, {
          headers: {
            'Authorization': `Bearer ${this.accessToken}`
          }
        });

        if (!response.ok) {
          throw new Error(`Error: ${response.statusText}`);
        }

        const data = await response.json();
        return data.data;
      }
    }

    const client = new ZipKitClient(ACCESS_TOKEN);
    const statusDiv = document.getElementById('status');

    document.getElementById('createZip').addEventListener('click', async () => {
      try {
        statusDiv.textContent = 'Creating ZIP...';

        const zip = await client.createZip({
          urls: ['https://example.com/file.pdf'],
          bucketName: 'my-bucket',
          key: 'browser-archive.zip'
        });

        statusDiv.textContent = `ZIP created! ID: ${zip.id}, Status: ${zip.status}`;

      } catch (error) {
        statusDiv.textContent = `Error: ${error.message}`;
      }
    });
  </script>
</body>
</html>
```

## Error Handling

```javascript
async function createZipWithErrorHandling(urls, bucketName) {
  const ACCESS_TOKEN = process.env.ZIPKIT_TOKEN;
  const API_URL = 'https://zipkit.io/api/v1';

  try {
    const response = await fetch(`${API_URL}/zips`, {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${ACCESS_TOKEN}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        urls,
        bucket_name: bucketName
      }),
      signal: AbortSignal.timeout(10000) // 10 second timeout
    });

    // Check response status
    if (response.status === 401) {
      throw new Error('Invalid access token');
    } else if (response.status === 404) {
      throw new Error('Bucket not found');
    } else if (response.status === 400) {
      const error = await response.json();
      throw new Error(`Bad request: ${error.message}`);
    } else if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    const data = await response.json();
    return data.data;

  } catch (error) {
    if (error.name === 'AbortError') {
      console.error('Request timed out');
    } else if (error.name === 'TypeError') {
      console.error('Network error or CORS issue');
    } else {
      console.error('Error:', error.message);
    }
    throw error;
  }
}

// Usage
createZipWithErrorHandling(
  ['https://example.com/file.pdf'],
  'my-bucket'
)
  .then(zip => console.log('Success:', zip))
  .catch(error => console.error('Failed:', error));
```

## Using Environment Variables

```javascript
// Load from .env file
require('dotenv').config();

const ACCESS_TOKEN = process.env.ZIPKIT_ACCESS_TOKEN;
const BUCKET_NAME = process.env.ZIPKIT_BUCKET_NAME;

if (!ACCESS_TOKEN) {
  throw new Error('ZIPKIT_ACCESS_TOKEN environment variable not set');
}

const client = new ZipKitClient(ACCESS_TOKEN);

async function createZip() {
  return await client.createZip({
    urls: ['https://example.com/file.pdf'],
    bucketName: BUCKET_NAME || 'default-bucket',
    key: 'archive.zip'
  });
}
```

Create a `.env` file:

```
ZIPKIT_ACCESS_TOKEN=your-access-token
ZIPKIT_BUCKET_NAME=my-bucket
```

## Next Steps

<CardGroup cols={2}>
  <Card title="Ruby Examples" icon="gem" href="/code-examples/ruby">
    See examples using Ruby's Net::HTTP
  </Card>

  <Card title="Python Examples" icon="python" href="/code-examples/python">
    See examples using Python's requests library
  </Card>

  <Card title="cURL Examples" icon="terminal" href="/code-examples/curl">
    See examples using cURL
  </Card>

  <Card title="API Reference" icon="book" href="/api-reference/create-zip">
    View complete API documentation
  </Card>
</CardGroup>
